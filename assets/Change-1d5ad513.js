import{d as ee,r as p,o as le,c as ae,b as f,e,f as t,h as u,i as y,v as te,A as oe,m as d,t as B,k as z,p as h,E as ne,z as E,_ as re}from"./index-97e706ba.js";const ue={class:"change-container"},se={class:"page-header"},de={class:"header-left"},pe={class:"toolbar"},ie={class:"pagination"},me={class:"dialog-footer"},ge=ee({__name:"Change",setup(ce){const q=p(),m=p({code:"",type:"",status:""}),$=p([]),V=p(1),k=p(10),j=p(0),v=p(!1),C=p("add"),x=p(),n=p({type:"",title:"",department:"",applicant:"",reason:"",content:"",riskAnalysis:"",controls:""}),F={type:[{required:!0,message:"请选择变更类型",trigger:"change"}],title:[{required:!0,message:"请输入变更标题",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],department:[{required:!0,message:"请输入所属部门",trigger:"blur"}],applicant:[{required:!0,message:"请输入申请人",trigger:"blur"}],reason:[{required:!0,message:"请输入变更原因",trigger:"blur"},{min:10,max:500,message:"长度在 10 到 500 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入变更内容",trigger:"blur"},{min:10,max:1e3,message:"长度在 10 到 1000 个字符",trigger:"blur"}],riskAnalysis:[{required:!0,message:"请输入风险分析",trigger:"blur"},{min:10,max:500,message:"长度在 10 到 500 个字符",trigger:"blur"}],controls:[{required:!0,message:"请输入管控措施",trigger:"blur"},{min:10,max:500,message:"长度在 10 到 500 个字符",trigger:"blur"}]},_=()=>{console.log("搜索条件：",m.value)},N=()=>{var o;(o=q.value)==null||o.resetFields()},R=()=>{C.value="add",n.value={type:"",title:"",department:"",applicant:"",reason:"",content:"",riskAnalysis:"",controls:""},v.value=!0},D=o=>{C.value="edit",n.value={...o},v.value=!0},M=o=>{console.log("查看详情：",o)},P=o=>{console.log("审批：",o)},I=o=>{ne.confirm("确定要取消该变更申请吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log("取消：",o),E.success("取消成功")})},G=async()=>{x.value&&await x.value.validate(o=>{o&&(console.log("表单数据：",n.value),v.value=!1,E.success("保存成功"))})},H=o=>{k.value=o,_()},J=o=>{V.value=o,_()},K=o=>({organization:"组织机构",personnel:"人员配置",equipment:"设备设施",operation:"作业方式",management:"管理制度"})[o]||o,L=o=>({pending:"info",approving:"warning",approved:"success",rejected:"danger",cancelled:"info"})[o]||"info",O=o=>({pending:"待审批",approving:"审批中",approved:"已通过",rejected:"已驳回",cancelled:"已取消"})[o]||o;return le(()=>{_()}),(o,l)=>{const Q=u("el-icon"),i=u("el-button"),g=u("el-input"),s=u("el-form-item"),r=u("el-option"),w=u("el-select"),S=u("el-form"),A=u("el-card"),c=u("el-table-column"),W=u("el-tag"),X=u("el-table"),Y=u("el-pagination"),b=u("el-col"),T=u("el-row"),Z=u("el-dialog");return y(),ae("div",ue,[f("div",se,[f("div",de,[l[16]||(l[16]=f("h2",null,"变更管理",-1)),f("div",pe,[e(i,{type:"primary",onClick:R},{default:t(()=>[e(Q,null,{default:t(()=>[e(te(oe))]),_:1}),l[15]||(l[15]=d("新增变更 "))]),_:1})])])]),e(A,{class:"search-card"},{default:t(()=>[e(S,{inline:!0,model:m.value,ref_key:"searchFormRef",ref:q},{default:t(()=>[e(s,{label:"变更编号"},{default:t(()=>[e(g,{modelValue:m.value.code,"onUpdate:modelValue":l[0]||(l[0]=a=>m.value.code=a),placeholder:"请输入变更编号",clearable:""},null,8,["modelValue"])]),_:1}),e(s,{label:"变更类型"},{default:t(()=>[e(w,{modelValue:m.value.type,"onUpdate:modelValue":l[1]||(l[1]=a=>m.value.type=a),placeholder:"请选择类型",clearable:""},{default:t(()=>[e(r,{label:"组织机构",value:"organization"}),e(r,{label:"人员配置",value:"personnel"}),e(r,{label:"设备设施",value:"equipment"}),e(r,{label:"作业方式",value:"operation"}),e(r,{label:"管理制度",value:"management"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"变更状态"},{default:t(()=>[e(w,{modelValue:m.value.status,"onUpdate:modelValue":l[2]||(l[2]=a=>m.value.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[e(r,{label:"待审批",value:"pending"}),e(r,{label:"审批中",value:"approving"}),e(r,{label:"已通过",value:"approved"}),e(r,{label:"已驳回",value:"rejected"}),e(r,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(i,{type:"primary",onClick:_},{default:t(()=>l[17]||(l[17]=[d("查询")])),_:1}),e(i,{onClick:N},{default:t(()=>l[18]||(l[18]=[d("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(A,{class:"table-card"},{default:t(()=>[e(X,{data:$.value,border:"",style:{width:"100%"}},{default:t(()=>[e(c,{prop:"code",label:"变更编号",width:"120"}),e(c,{prop:"type",label:"变更类型",width:"120"},{default:t(({row:a})=>[d(B(K(a.type)),1)]),_:1}),e(c,{prop:"title",label:"变更标题"}),e(c,{prop:"applicant",label:"申请人",width:"100"}),e(c,{prop:"department",label:"所属部门",width:"120"}),e(c,{prop:"applyDate",label:"申请日期",width:"120"}),e(c,{prop:"status",label:"状态",width:"100"},{default:t(({row:a})=>[e(W,{type:L(a.status)},{default:t(()=>[d(B(O(a.status)),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"操作",width:"250",fixed:"right"},{default:t(({row:a})=>[e(i,{type:"primary",link:"",onClick:U=>M(a)},{default:t(()=>l[19]||(l[19]=[d("查看")])),_:2},1032,["onClick"]),a.status==="pending"?(y(),z(i,{key:0,type:"primary",link:"",onClick:U=>D(a)},{default:t(()=>l[20]||(l[20]=[d("编辑")])),_:2},1032,["onClick"])):h("",!0),a.status==="pending"||a.status==="approving"?(y(),z(i,{key:1,type:"success",link:"",onClick:U=>P(a)},{default:t(()=>l[21]||(l[21]=[d("审批")])),_:2},1032,["onClick"])):h("",!0),a.status==="pending"?(y(),z(i,{key:2,type:"danger",link:"",onClick:U=>I(a)},{default:t(()=>l[22]||(l[22]=[d("取消")])),_:2},1032,["onClick"])):h("",!0)]),_:1})]),_:1},8,["data"]),f("div",ie,[e(Y,{"current-page":V.value,"onUpdate:currentPage":l[3]||(l[3]=a=>V.value=a),"page-size":k.value,"onUpdate:pageSize":l[4]||(l[4]=a=>k.value=a),total:j.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:J},null,8,["current-page","page-size","total"])])]),_:1}),e(Z,{modelValue:v.value,"onUpdate:modelValue":l[14]||(l[14]=a=>v.value=a),title:C.value==="add"?"新增变更":"编辑变更",width:"60%"},{footer:t(()=>[f("span",me,[e(i,{onClick:l[13]||(l[13]=a=>v.value=!1)},{default:t(()=>l[23]||(l[23]=[d("取消")])),_:1}),e(i,{type:"primary",onClick:G},{default:t(()=>l[24]||(l[24]=[d("确定")])),_:1})])]),default:t(()=>[e(S,{ref_key:"formRef",ref:x,model:n.value,rules:F,"label-width":"100px"},{default:t(()=>[e(T,{gutter:20},{default:t(()=>[e(b,{span:12},{default:t(()=>[e(s,{label:"变更类型",prop:"type"},{default:t(()=>[e(w,{modelValue:n.value.type,"onUpdate:modelValue":l[5]||(l[5]=a=>n.value.type=a),placeholder:"请选择类型",style:{width:"100%"}},{default:t(()=>[e(r,{label:"组织机构",value:"organization"}),e(r,{label:"人员配置",value:"personnel"}),e(r,{label:"设备设施",value:"equipment"}),e(r,{label:"作业方式",value:"operation"}),e(r,{label:"管理制度",value:"management"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(b,{span:12},{default:t(()=>[e(s,{label:"变更标题",prop:"title"},{default:t(()=>[e(g,{modelValue:n.value.title,"onUpdate:modelValue":l[6]||(l[6]=a=>n.value.title=a),placeholder:"请输入变更标题"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(b,{span:12},{default:t(()=>[e(s,{label:"所属部门",prop:"department"},{default:t(()=>[e(g,{modelValue:n.value.department,"onUpdate:modelValue":l[7]||(l[7]=a=>n.value.department=a),placeholder:"请输入所属部门"},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{span:12},{default:t(()=>[e(s,{label:"申请人",prop:"applicant"},{default:t(()=>[e(g,{modelValue:n.value.applicant,"onUpdate:modelValue":l[8]||(l[8]=a=>n.value.applicant=a),placeholder:"请输入申请人"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s,{label:"变更原因",prop:"reason"},{default:t(()=>[e(g,{modelValue:n.value.reason,"onUpdate:modelValue":l[9]||(l[9]=a=>n.value.reason=a),type:"textarea",rows:"3",placeholder:"请输入变更原因"},null,8,["modelValue"])]),_:1}),e(s,{label:"变更内容",prop:"content"},{default:t(()=>[e(g,{modelValue:n.value.content,"onUpdate:modelValue":l[10]||(l[10]=a=>n.value.content=a),type:"textarea",rows:"4",placeholder:"请输入变更内容"},null,8,["modelValue"])]),_:1}),e(s,{label:"风险分析",prop:"riskAnalysis"},{default:t(()=>[e(g,{modelValue:n.value.riskAnalysis,"onUpdate:modelValue":l[11]||(l[11]=a=>n.value.riskAnalysis=a),type:"textarea",rows:"3",placeholder:"请输入风险分析"},null,8,["modelValue"])]),_:1}),e(s,{label:"管控措施",prop:"controls"},{default:t(()=>[e(g,{modelValue:n.value.controls,"onUpdate:modelValue":l[12]||(l[12]=a=>n.value.controls=a),type:"textarea",rows:"3",placeholder:"请输入管控措施"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const fe=re(ge,[["__scopeId","data-v-762e41af"]]);export{fe as default};
