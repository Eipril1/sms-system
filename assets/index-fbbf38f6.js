import{d as oe,L as B,r as p,o as se,q as de,c as x,b as n,e as t,f as l,z as k,h as d,M as re,i as w,m as u,t as m,F as q,j as F,N as ue,k as ie,E as pe,_ as me}from"./index-97e706ba.js";const ce={class:"check-plan"},_e={class:"page-header"},ve={class:"statistics-value"},fe={class:"number"},ge={class:"statistics-value"},he={class:"number"},Ce={class:"sub-info"},be={class:"completed"},ye={class:"pending"},ke={class:"statistics-value"},we={class:"number"},Ve={class:"statistics-value"},Me={class:"number"},Pe={class:"sub-info"},Ye={class:"completed"},xe={class:"pending"},Re={class:"search-wrapper"},ze={class:"card-header"},Se={class:"header-operations"},Ue={class:"pagination-container"},Ne=oe({__name:"index",setup(De){const o=B({yearCompletionRate:78,yearPlannedCount:120,yearCompletedCount:94,yearPendingCount:26,monthCompletionRate:85,monthPlannedCount:12,monthCompletedCount:8,monthPendingCount:4}),v=p({planMonth:"",department:"",status:""}),j=p([{planNo:"JH202401001",planMonth:"2024-01",department:"飞行部",checkCount:4,completedCount:2,status:"进行中",createTime:"2024-01-01 10:00:00"}]),b=p(!1),V=p(1),R=p(10),L=p(1),z=[{label:"飞行部",value:"飞行部"},{label:"维修部",value:"维修部"},{label:"运控部",value:"运控部"},{label:"客舱部",value:"客舱部"},{label:"货运部",value:"货运部"},{label:"安全部",value:"安全部"}],f=p(!1),g=p("add"),M=p(),r=B({planNo:"",planMonth:"",department:"",checkCount:1,remark:""}),O={planMonth:[{required:!0,message:"请选择计划月份",trigger:"change"}],department:[{required:!0,message:"请选择检查部门",trigger:"change"}],checkCount:[{required:!0,message:"请输入检查次数",trigger:"blur"}]},A=s=>({未开始:"info",进行中:"warning",已完成:"success"})[s]||"info",H=s=>s?s.replace(/(\d{4})-(\d{2})/,"$1年$2月"):"",I=()=>{k.success("导出成功")},P=p(!1),S=()=>{V.value=1,U()},U=async()=>{b.value=!0;try{await new Promise(s=>setTimeout(s,1e3)),b.value=!1}catch{b.value=!1,k.error("获取数据失败")}},J=async()=>{if(M.value)try{await M.value.validate(),P.value=!0,await new Promise(s=>setTimeout(s,1e3)),f.value=!1,k.success(g.value==="add"?"新增成功":"修改成功"),S()}catch{}finally{P.value=!1}};se(()=>{U()});const N=()=>{g.value="add",r.planNo="",r.planMonth="",r.department="",r.checkCount=1,r.remark="",f.value=!0},G=s=>{g.value="edit",Object.assign(r,s),f.value=!0},K=s=>{console.log("查看计划：",s)},Q=async s=>{try{await pe.confirm("确认删除该检查计划？","提示",{type:"warning"}),k.success("删除成功")}catch{}};return de(()=>[{title:"年度计划完成率",value:o.yearCompletionRate,showProgress:!0},{title:"年度检查计划",value:o.yearPlannedCount,completed:o.yearCompletedCount,pending:o.yearPendingCount,showProgress:!1},{title:"本月完成率",value:o.monthCompletionRate,showProgress:!0},{title:"本月检查计划",value:o.monthPlannedCount,completed:o.monthCompletedCount,pending:o.monthPendingCount,showProgress:!1}]),(s,e)=>{const i=d("el-button"),D=d("el-progress"),h=d("el-card"),y=d("el-col"),W=d("el-row"),T=d("el-date-picker"),c=d("el-form-item"),C=d("el-option"),Y=d("el-select"),E=d("el-form"),_=d("el-table-column"),X=d("el-tag"),Z=d("el-table"),ee=d("el-pagination"),te=d("el-input-number"),le=d("el-input"),ae=d("el-dialog"),ne=re("loading");return w(),x("div",ce,[n("div",_e,[e[12]||(e[12]=n("h2",null,"检查计划",-1)),t(i,{type:"primary",onClick:N},{default:l(()=>e[11]||(e[11]=[u("新增计划")])),_:1})]),t(W,{gutter:20,class:"statistics"},{default:l(()=>[t(y,{span:6},{default:l(()=>[t(h,{shadow:"hover",class:"statistics-card"},{header:l(()=>e[13]||(e[13]=[n("div",{class:"card-header"},[n("span",null,"年度计划完成率")],-1)])),default:l(()=>[n("div",ve,[n("span",fe,m(o.yearCompletionRate)+"%",1),t(D,{percentage:o.yearCompletionRate,status:o.yearCompletionRate>=90?"success":"warning"},null,8,["percentage","status"])])]),_:1})]),_:1}),t(y,{span:6},{default:l(()=>[t(h,{shadow:"hover",class:"statistics-card"},{header:l(()=>e[14]||(e[14]=[n("div",{class:"card-header"},[n("span",null,"年度检查计划")],-1)])),default:l(()=>[n("div",ge,[n("span",he,m(o.yearPlannedCount),1),n("div",Ce,[n("span",be,"已完成: "+m(o.yearCompletedCount),1),n("span",ye,"待执行: "+m(o.yearPendingCount),1)])])]),_:1})]),_:1}),t(y,{span:6},{default:l(()=>[t(h,{shadow:"hover",class:"statistics-card"},{header:l(()=>e[15]||(e[15]=[n("div",{class:"card-header"},[n("span",null,"本月完成率")],-1)])),default:l(()=>[n("div",ke,[n("span",we,m(o.monthCompletionRate)+"%",1),t(D,{percentage:o.monthCompletionRate,status:o.monthCompletionRate>=90?"success":"warning"},null,8,["percentage","status"])])]),_:1})]),_:1}),t(y,{span:6},{default:l(()=>[t(h,{shadow:"hover",class:"statistics-card"},{header:l(()=>e[16]||(e[16]=[n("div",{class:"card-header"},[n("span",null,"本月检查计划")],-1)])),default:l(()=>[n("div",Ve,[n("span",Me,m(o.monthPlannedCount),1),n("div",Pe,[n("span",Ye,"已完成: "+m(o.monthCompletedCount),1),n("span",xe,"待执行: "+m(o.monthPendingCount),1)])])]),_:1})]),_:1})]),_:1}),n("div",Re,[t(E,{inline:!0,model:v.value,ref:"searchFormRef"},{default:l(()=>[t(c,{label:"计划月份"},{default:l(()=>[t(T,{modelValue:v.value.planMonth,"onUpdate:modelValue":e[0]||(e[0]=a=>v.value.planMonth=a),type:"month",placeholder:"选择月份",format:"YYYY年MM月","value-format":"YYYY-MM"},null,8,["modelValue"])]),_:1}),t(c,{label:"检查部门"},{default:l(()=>[t(Y,{modelValue:v.value.department,"onUpdate:modelValue":e[1]||(e[1]=a=>v.value.department=a),placeholder:"请选择",clearable:""},{default:l(()=>[(w(),x(q,null,F(z,a=>t(C,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"状态"},{default:l(()=>[t(Y,{modelValue:v.value.status,"onUpdate:modelValue":e[2]||(e[2]=a=>v.value.status=a),placeholder:"请选择",clearable:""},{default:l(()=>[t(C,{label:"未开始",value:"未开始"}),t(C,{label:"进行中",value:"进行中"}),t(C,{label:"已完成",value:"已完成"})]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:l(()=>[t(i,{type:"primary",onClick:S},{default:l(()=>e[17]||(e[17]=[u("查询")])),_:1}),t(i,{onClick:s.resetSearch},{default:l(()=>e[18]||(e[18]=[u("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),t(h,{class:"table-card"},{header:l(()=>[n("div",ze,[e[21]||(e[21]=n("span",null,"检查计划列表",-1)),n("div",Se,[t(i,{type:"primary",onClick:N},{default:l(()=>e[19]||(e[19]=[u("新增计划")])),_:1}),t(i,{type:"success",onClick:I},{default:l(()=>e[20]||(e[20]=[u("导出")])),_:1})])])]),default:l(()=>[ue((w(),ie(Z,{data:j.value,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(_,{prop:"planNo",label:"计划编号",width:"120"}),t(_,{prop:"planMonth",label:"计划月份",width:"120"},{default:l(({row:a})=>[u(m(H(a.planMonth)),1)]),_:1}),t(_,{prop:"department",label:"检查部门",width:"120"}),t(_,{prop:"checkCount",label:"检查次数",width:"100",align:"center"}),t(_,{prop:"completedCount",label:"已完成",width:"100",align:"center"}),t(_,{prop:"status",label:"状态",width:"100",align:"center"},{default:l(({row:a})=>[t(X,{type:A(a.status)},{default:l(()=>[u(m(a.status),1)]),_:2},1032,["type"])]),_:1}),t(_,{prop:"createTime",label:"创建时间",width:"180"}),t(_,{label:"操作",width:"220",fixed:"right"},{default:l(({row:a})=>[t(i,{link:"",type:"primary",onClick:$=>G(a)},{default:l(()=>e[22]||(e[22]=[u("编辑")])),_:2},1032,["onClick"]),t(i,{link:"",type:"primary",onClick:$=>K(a)},{default:l(()=>e[23]||(e[23]=[u("查看")])),_:2},1032,["onClick"]),t(i,{link:"",type:"danger",onClick:$=>Q(a),disabled:a.status!=="未开始"},{default:l(()=>e[24]||(e[24]=[u("删除")])),_:2},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[ne,b.value]]),n("div",Ue,[t(ee,{"current-page":V.value,"onUpdate:currentPage":e[3]||(e[3]=a=>V.value=a),"page-size":R.value,"onUpdate:pageSize":e[4]||(e[4]=a=>R.value=a),total:L.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),t(ae,{title:g.value==="add"?"新增检查计划":"编辑检查计划",modelValue:f.value,"onUpdate:modelValue":e[10]||(e[10]=a=>f.value=a),width:"600px","close-on-click-modal":!1},{footer:l(()=>[t(i,{onClick:e[9]||(e[9]=a=>f.value=!1)},{default:l(()=>e[25]||(e[25]=[u("取消")])),_:1}),t(i,{type:"primary",onClick:J,loading:P.value},{default:l(()=>e[26]||(e[26]=[u("确定")])),_:1},8,["loading"])]),default:l(()=>[t(E,{ref_key:"formRef",ref:M,model:r,rules:O,"label-width":"100px","status-icon":""},{default:l(()=>[t(c,{label:"计划月份",prop:"planMonth"},{default:l(()=>[t(T,{modelValue:r.planMonth,"onUpdate:modelValue":e[5]||(e[5]=a=>r.planMonth=a),type:"month",placeholder:"选择月份",format:"YYYY年MM月","value-format":"YYYY-MM",style:{width:"100%"},disabled:g.value==="edit"},null,8,["modelValue","disabled"])]),_:1}),t(c,{label:"检查部门",prop:"department"},{default:l(()=>[t(Y,{modelValue:r.department,"onUpdate:modelValue":e[6]||(e[6]=a=>r.department=a),placeholder:"请选择",style:{width:"100%"},disabled:g.value==="edit"},{default:l(()=>[(w(),x(q,null,F(z,a=>t(C,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","disabled"])]),_:1}),t(c,{label:"检查次数",prop:"checkCount"},{default:l(()=>[t(te,{modelValue:r.checkCount,"onUpdate:modelValue":e[7]||(e[7]=a=>r.checkCount=a),min:1,max:99,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(c,{label:"备注",prop:"remark"},{default:l(()=>[t(le,{modelValue:r.remark,"onUpdate:modelValue":e[8]||(e[8]=a=>r.remark=a),type:"textarea",rows:"3",placeholder:"请输入备注信息",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}});const Ee=me(Ne,[["__scopeId","data-v-30acebe7"]]);export{Ee as default};
